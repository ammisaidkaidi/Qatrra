/* esm.sh - @supabase/postgrest-js@2.76.1 */
import*as __0$ from"/tslib@2.8.1/es2022/tslib.mjs";import*as __1$ from"/@supabase/node-fetch@2.6.15/es2022/node-fetch.mjs";var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({__esModule:true},m);switch(n){case"tslib":return c(__0$);case"@supabase/node-fetch":return e(__1$);default:console.error('module "'+n+'" not found');return null;}};
var Y=Object.create;var R=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var p=(h=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(h,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):h)(function(h){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+h+'" is not supported')});var m=(h,e)=>()=>(e||h((e={exports:{}}).exports,e),e.exports);var re=(h,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ee(e))!se.call(h,r)&&r!==t&&R(h,r,{get:()=>e[r],enumerable:!(s=Z(e,r))||s.enumerable});return h};var ie=(h,e,t)=>(t=h!=null?Y(te(h)):{},re(e||!h||!h.__esModule?R(t,"default",{value:h,enumerable:!0}):t,h));var b=m(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});var w=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};O.default=w});var B=m(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});var F=p("tslib"),ae=F.__importDefault(p("@supabase/node-fetch")),ne=F.__importDefault(b()),q=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ae.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");let s=this.fetch,r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,n,l,c;let u=null,o=null,f=null,g=i.status,_=i.statusText;if(i.ok){if(this.method!=="HEAD"){let j=await i.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?o=j:o=JSON.parse(j))}let $=(n=this.headers.get("Prefer"))===null||n===void 0?void 0:n.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");$&&v&&v.length>1&&(f=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(o)&&(o.length>1?(u={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,f=null,g=406,_="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{let $=await i.text();try{u=JSON.parse($),Array.isArray(u)&&i.status===404&&(o=[],u=null,g=200,_="OK")}catch{i.status===404&&$===""?(g=204,_="No Content"):u={message:$}}if(u&&this.isMaybeSingle&&(!((c=u?.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,g=200,_="OK"),u&&this.shouldThrowOnError)throw new ne.default(u)}return{error:u,data:o,count:f,status:g,statusText:_}});return this.shouldThrowOnError||(r=r.catch(i=>{var a,n,l;return{error:{message:`${(a=i?.name)!==null&&a!==void 0?a:"FetchError"}: ${i?.message}`,details:`${(n=i?.stack)!==null&&n!==void 0?n:""}`,hint:"",code:`${(l=i?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};k.default=q});var T=m(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var he=p("tslib"),le=he.__importDefault(B()),x=class extends le.default{select(e){let t=!1,s=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){let a=i?`${i}.order`:"order",n=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${n?`${n},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){let r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){let i=typeof r>"u"?"offset":`${r}.offset`,a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:a="text"}={}){var n;let l=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(n=this.headers.get("Accept"))!==null&&n!==void 0?n:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};S.default=x});var A=m(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var ue=p("tslib"),oe=ue.__importDefault(T()),E=class extends oe.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let s=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");let a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){let r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};D.default=E});var C=m(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});var de=p("tslib"),y=de.__importDefault(A()),H=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=r}select(e,t){let{head:s=!1,count:r}=t??{},i=s?"HEAD":"GET",a=!1,n=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",n),r&&this.headers.append("Prefer",`count=${r}`),new y.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var r;let i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let a=e.reduce((n,l)=>n.concat(Object.keys(l)),[]);if(a.length>0){let n=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",n.join(","))}}return new y.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){var a;let n="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),r&&this.headers.append("Prefer",`count=${r}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){let c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new y.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var s;let r="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new y.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;let s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new y.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};M.default=H});var L=m(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});var J=p("tslib"),ce=J.__importDefault(C()),fe=J.__importDefault(A()),N=class h{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=r}from(e){let t=new URL(`${this.url}/${e}`);return new ce.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new h(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){var a;let n,l=new URL(`${this.url}/rpc/${e}`),c;s||r?(n=s?"HEAD":"GET",Object.entries(t).filter(([o,f])=>f!==void 0).map(([o,f])=>[o,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([o,f])=>{l.searchParams.append(o,f)})):(n="POST",c=t);let u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new fe.default({method:n,url:l,headers:u,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};G.default=N});var W=m(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.PostgrestError=d.PostgrestBuilder=d.PostgrestTransformBuilder=d.PostgrestFilterBuilder=d.PostgrestQueryBuilder=d.PostgrestClient=void 0;var P=p("tslib"),Q=P.__importDefault(L());d.PostgrestClient=Q.default;var K=P.__importDefault(C());d.PostgrestQueryBuilder=K.default;var U=P.__importDefault(A());d.PostgrestFilterBuilder=U.default;var z=P.__importDefault(T());d.PostgrestTransformBuilder=z.default;var I=P.__importDefault(B());d.PostgrestBuilder=I.default;var V=P.__importDefault(b());d.PostgrestError=V.default;d.default={PostgrestClient:Q.default,PostgrestQueryBuilder:K.default,PostgrestFilterBuilder:U.default,PostgrestTransformBuilder:z.default,PostgrestBuilder:I.default,PostgrestError:V.default}});var X=ie(W(),1),{PostgrestClient:pe,PostgrestQueryBuilder:me,PostgrestFilterBuilder:Pe,PostgrestTransformBuilder:ge,PostgrestBuilder:_e,PostgrestError:$e}=X.default;var Be={PostgrestClient:pe,PostgrestQueryBuilder:me,PostgrestFilterBuilder:Pe,PostgrestTransformBuilder:ge,PostgrestBuilder:_e,PostgrestError:$e};export{_e as PostgrestBuilder,pe as PostgrestClient,$e as PostgrestError,Pe as PostgrestFilterBuilder,me as PostgrestQueryBuilder,ge as PostgrestTransformBuilder,Be as default};
//# sourceMappingURL=postgrest-js.mjs.map